# 7장 비모수 통계
* 데이터의 종류
    * 질적 데이터
        * 범주 데이터
        * 순위 데이터
    * 양적 데이터
        * 간격 데이터
        * 비율 데이터
* 모수 검정
    * 모집단이 특정 확률분포를 따른다는 전제가 되어 있는 통계 방식
    * t검정이나 분산분석에서는 모집단이 정규분포를 따른다는 가정이 필요함
* 비모수 검정
    * 모집단에 대해 아무런 확률분포도 가정하지 않는 통계 방식
    * 비모수 검정이 유효한 경우
        * 질적 데이터의 경우
            * 확률변수가 아니기 때문에 확률분포 자체를 가정할 수 없음
            * 평균 값을 계산할 수도 없음
        * 극단적인 값이 있는 경우
            * 검출력이 떨어짐
    * 종류
        * 독립성 검정(피어슨의 카이제곱 검정)
            * 가설
                * 귀무가설 : 행변수와 열변수가 독립이다
                * 대립가설 : 행변수와 열변수가 독립이 아니다
            * 행변수와 열변수가 독립 되어 있는지, 관계 유무를 검증함
            * 관측도수가 기대도수의 분포를 따른다고 하는 귀무가설을 카이제곱 분포를 사용해 검정
                * 아이디어
                    * 관측된 도수분포와 기대되는 도수분포간에 괴리가 크면 귀무가설을 기각함
                * 도수
                    * 사건이 일어난 횟수
                * 관측도수
                    * 관측된 행렬의 도수
                * 기대도수
                    * 행변수와 열변수가 독립되어 있다는 귀무가설하에서 기대되는 행렬의 도수
                    * 관측도수 행렬의 합계 비율을 역산해 구함
                * 검정통계량
                    * 귀무가설하에서 기대되는 도수분포와 관측된 도수분포의 괴리크기
                    * 카이제곱 분포를 근사적으로 따르는 통계량
                        * 엄밀하게는 총도수가 클 경우에 카이제곱 분포를 근사적으로 따르지만, 편의상 카이제곱 분포를 따른다고 함
                        * 자유도 : (행의 수 - 1) * (열의 수 - 1)
                * 독립성 검정의 약점과 보정
                    * 2행 * 2열 분할표에 소표본인 경우 p값이 원래보다 작아져 제 1종 과오를 과소평가 하는 상황이 발생함
                        * (예이츠)연속성 보정을 통해 검정통게량을 좀 작게 보정함
                            * 연속성 보정
                                * 실제의 통계량이 이산형인데 근사시킨 연속형 확률분포로 검정하면 제 1종 과오를 범하기 쉬워져서 검정 통계량을 약간 작게 보정하는 것
                * 관련계수
                    * 독립성 검정에서 행변수와 열변수간에 강한 관련성을 나타내는 지표
                    * 0~1의 값을 취함
                    * 크라메르 관련계수가 유명함
                * 적합도 검정
                    * 관측도수분포가 이론상의 기대도수분포와 같은지 검정
                    * 카이제곱분포를 사용함
        * 피셔의 정확검정(2 * 2 분할표 검정)
            * 가설
                * 귀무가설 : 모비율에 차이가 없다
                * 대립가설 : 모비율에 차이가 있다
            * 소표본의 2*2 분할표에 사용하는 검정 방식
                * factorial을 사용하여 연산량이 많기 때문에 소표본에 적합
            * 독립성 검정에서 예이츠 보정을 한 경우보다도 옳은 결과를 얻을 수 있음
            * 아이디어
                * 모비율에 차이가 없을 때는 관측도수 배치가 치우지지 않음
                * 반대로 모비율에 차이가 있을 때는 도수 배치에 치우침이 생김
            * 주변 도수를 고정한 상태에서 관측된 도수 배치보다 치우침이 커지는 확률을 직접 구해 유의수준과 비교함
                * 주변 도수
                    * 행의 도수 합계, 열의 도수 합계
                * 주변도수를 고정한 이유
                    * 경우의 수를 많이 줄임
                    * 조합을 통해 확률을 계산함
        * 맨·휘트니의 U 검정(대응이 없는 두 집단의 순서 데이터 검정)
            * 가설
                * 귀무가설 : (대응이 없는)두 집단의 순서관계에 치우침(차이)이 없음
                * 대립가설 : (대응이 없는)두 집단의 순서관계에 치우침(차이)이 없음
            * 대응이 없는 두 집단의 평균 차이 검정의 비모수판 -> 중앙값의 차이 검정
            * 순위데이터나 극단적인 값이 있는 양적 데이터에 이용
                * 양적데이터는 순위데이터로 변환하기 때문에 극단적인 값을 대처 할 수 있음
            * 순위 데이터로 변환해 분포가 겹치는 정도를 나타내는 통계량(U값)을 계산하고 한계값과 비교하여 귀무가설 기각여부 결정
                * 검정통계량 U값
                    1. 양 집단을 순위 데이터로 변환
                        * 양 집단이라는 틀은 유지하면서, 순위는 함께 고려해서 변환
                        * 같은 값은 평균값을 부여함
                    2. 한쪽 집단의 각각 순위를 Ai(i = 1, ..., nA)라 할 때, Ai : Ai보다 작은 Bk(k = 1, ..., nB) 의 갯수 관계를 구함
                    3. U 값 = Sum(Ai)
                        * 정확히는 Bk : Bk보다 작은 Ai의 갯수 관계도 구해서 Sum(Ai) vs Sum(Bk)를 비교해서 작은 값을 U값으로 취하고, 하측에서 검정을 진행함
                * U 분포
                    * 소표본인 경우(양집단 모두 표본 크기가 20개 미만)
                        * 0 ~ nA * nB, 좌우 대칭
                        * U 검정표 이용
                    * 대표본인 경우(둘 중 한집단 또는 두집단 모두의 표본크기가 20보다 클 경우)
                        * 근사적으로 정규분포를 따름
                        * z 검정을 이용함
            * 아이디어
                * U 값은 양 집단의 순위 배치가 가까울수록 U 분포 중앙에, 반대로 다를수록 양측에 존재함
            * 동점(tie)
                * 순위 데이터 검정에서는 동점이 많으면 검정통계량 작게 계산되어 검출력이 떨어짐. 이를 피하기 위해서는 미리 표준오차를 조금 작게 보정해서 검정통계량을 조금 크게 보정함
        * 부호검정(대응이 있는 두 집단의 순서 데이터 검정)
            * 가설
                * 귀무가설 : (대응이 있는)두 집단의 차이가 없다
                * 대립가설 : (대응이 있는)두 집단의 차이가 있다
            * 대응이 있는 두 집단의 평균 값차이 검정의 비모수 검정판
            * 대응이 있는 두 집단의 순위 데이터 비모수 검정
                * 대응이 있기 때문에 두 집단의 표본크기는 같음
            * 차이의 대소(스케일)을 고려하지 않기 때문에 순위데이터에 이용함
            * 각 쌍마다 취한 차이의 부호 수에 주목해 검정함
                * 검정통계량(r값)
                    1. Ci : sign(Ai - Bi)(i = 1,...,nA(=nB))를 구함
                    2. Ci에서 플러스, 마이너스별로 갯수를 구함
                    3. 적은 쪽이 검정 통계량 r값으로 하고, 하측으로 검정함
                * 분포
                    * 소표본인 경우(nA = nB <= 25)
                        * r ~ B(nA(=nB),  1/2)
                        * 이항 분포표를 이용하거나 직접 계산해서 검정
                    * 대표본인 경우(nA = nB > 25)
                        * 정규분포를 따르고 z 검정 이용
                        * 일반적으로 연속성 보정을 함
            * 아이디어
                * 양 집단의 차이가 없으면 플러스, 마이너스의 수는 거의 같음
                * 양 집단의 차이가 있으면 플러스, 마이너스의 수는 한쪽으로 치우침
        * 윌콕슨의 부호순위검정(대응이 있는 두 집단의 양적 데이터 비모수 검정)
            * 가설
                * 귀무가설 : (대응이 있는)두 집단의 차이가 없다
                * 대립가설 : (대응이 있는)두 집단의 차이가 있다
            * 대응이 있는 두 집단의 양적 데이터 비모수 검정
            * 집단 간 차이 크기(스케일)을 이용하기 때문에 양적 데이터밖에 이용할 수 없음
            * 검정통계량(T값)
                1. Ci = Ai - Bi(i = 1, ..., nA(=nB))를 구함
                2. Ci를 절댓값이 작은순으로 순위를 매김
                3. 자신들의 원래 부호를 기준으로, 수가 적은 부호에서 순위의 합을 검정통계량 T값으로 하고 하측으로 검정함
            * 분포
                * 소표본인 경우(nA = nB <= 25)
                    * 0 ~ n(n+1)/2, 좌우대칭
                    * 전용표를 이용해 검정함
                * 대표본인 경우(nA = nB > 25)
                    * 정규분포를 따르고, z 검정을 이용함
                    * 표준오차가 충분히 크기 때문에 연속성 보정을 하지 않음
        * 크러스컬·윌리스 검정(대응이 없는 여러 집단의 순서 데이터 검정)
            * 가설
                * 귀무가설 : (대응이 없는)여러 집단간에 차이가 없다
                * 대립가설 : (대응이 없는)여러 집단간에 차이가 있다
            * 대응이 없는 여러 집단의 차이의 비모수 검정판
                * 일원배치 분산분석의 비모수 검정판
            * 순위 데이터나 극단적인 값이 있는 경우, 집단 간에서 등분산을 가정 할 수 없는 경우, 데이터의 수가 극단적으로 다른 경우 유효함
            * 맨·휘트니 U 검정을 여러 집단에 확장하는 방식으로, 카이제곱 분포에 근사적으로 따르는 통계량을 구함
                * 검정통계량(H값)
                    1. 전 집단을 정리해서 순위를 붙이고, 각 집단마다 순위합 R을 계산함
                    2. 순위합 R을 보정함으로써 카이제곱 분포를 따르는 검정통계량 H값을 구하고 상측만으로 검정함
                * H검정
                    * 소표본인 경우(세 집단일 때 17이하, 네 집단일 때 14이하 - 전체 데이터 갯수 기준인 것 같음)
                        * 카이제곱 검정을 그대로 하면 검출력이 떨어지기 때문에 전용표를 이용
                    * 대표본인 경우
                        * 카이제곱 분포표를 이용해서 한계값을 구함
                            * 카이제곱 분포의 자유도는 집단 수에서 1을 뺀 값
            * 아이디어
                * 집단 간 분포가 다를수록 각 집단의 순위합 R의 치우침이 커짐
        * 프리드먼 검정(대응이 있는 여러 집단의 순서 데이터 검정)
            * 가설
                * 귀무가설 : (대응이 있는)여러 집단간에 차이가 없다
                * 대립가설 : (대응이 있는)여러 집단간에 차이가 있다
            * 대응이 있는 여러 집단의 차이의 비모수판
                * 대응이 있는 일원배치 분산분석의 비모수 검정판
            * 순위 데이터나 극단적인 값이 있는 양적데이터에 유효함
            * 크러스컬·윌리스 검정과 거의 같은 내용이지만, 개체 내에서 붙인 순위를 사용해 순위합 R을 계산하기 때문에 개체 차이를 고려할 수 있음
                * 검정통계량(Q값)
                    1. 개체 내에서 순위를 구하고, 각 집단마다 순위합 R을 계산함
                    2. 순위합 R을 보정함으로써 카이제곱 분포를 따르는 검정통계량 Q값을 구하고 상측만으로 검정함
                * 프리드먼 검정
                    * 소표본인 경우(세 집단일 때 9 이하, 네 집단일 때 5이하)
                        * 카이제곱 분포를 그대로 하면 검출력이 떨어지기 때문에 전용표를 이용함
                    * 대표본인 경우
                        * 카이제곱 분포표를 이용해서 한게값을 구함
                            * 카이제곱 분포의 자유도는 집단의 수에서 1을 뺸 값
            * 아이디어
                * 집단 간 분포 위치가 다르면 순위합 R의 치우침이 커짐
            * 켄달의 일치 계수(W)
                * 각 개체내에서 붙인 순위의 일치도를 나타낸 통계량
                * 개체마다 더한 순위합의 분산을 그 이론의 최댓값으로 나눔
                * 0 ~ 1
* caution
    * 양적데이터에서 극단적인 값이 있을 경우, 정규분포를 가정하기 어려움
        * 비모수 검정으로 접근이 유용함
        *  모수 검정을 하고 싶은 경우 로그를 취해 스케일을 변경해서 진행함
            * 모수 검정은 보통 정규성을 가정하기 때문에 로그 스케일로 변경해서 정규분포를 따른다고 가정함
