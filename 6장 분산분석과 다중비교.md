# 6장 분산분석과 다중비교
* 분산분석(analysis of variance, ANOVA)
    * 세 집단 이상의 평균값 차이를 검정하는 방법
        * 평균 차이의 검정을 세 집단 이상으로 확장한 것으로, F 분포를 사용해 검정
    * 여러 요인(factor >= 2)의 교호작용(상승효과나 상쇄효과)을 검정할 수 있음
    * 실험의 목적이 되는 요인(Factor)이 결과에 영향을 미쳤는지의 여부를 판정함
        * 연구 목적이 되는 요인효과(MSA)가 오차효과보다 클 때(MSE) 그 비율인 F 값이 커진다는 것을 이용함
        * 우연의 범위 내인지 아닌지를 확률로 판정
    * 정규분포 가정이 필요(오차)
    * 종류
        * 일원배치 분산분석(one-way ANOVA)
            * 실험의 목적이 되는 요인(인자)이 하나인 경우의 대응이 없는 가장 기본적인 분산분석
            * 인위적으로 처리조건을 변화(ex> 다른 비료)시킨 요인(ex> 비료 없음, 비료 A, 비료 B)이 실험 결과에 영향을 미치는지 확인
            * 구체적으로..
                * 총변동(SST)
                    * 실험에서 관측된 데이터 전체의 변동
                    * 검정에는 사용되지 않음
                    * SST = SSA + SSE
                * 군간변동(SSA)
                    * 목적이 되는 요인의 효과에 의해 생기는 변동
                    * 자유도(df) : 집단수(요인의 종류) - 1
                    * MSA
                        * 검정통계량의 분자
                        * SSA / df
                * 군내변동(SSE)
                    * 오차 효과에 의해 생기는 변동
                    * 자유도(df) : 데이터 수 - 집단 수
                    * MSE
                        * 검정통계량의 분모
                        * SSE / df
                * 검정통계량
                    * F = MSA / MSE
                * 가설
                    * 귀무가설 : 요인효과가 없다
                    * 대립가설 : 오인효과가 있다
                * 가설의 판정
                    * p-value와 유의수준 비교
                    * 검정통계량과 임계값(한계값) 비교
            * 아이디어
                * 군간변동이 상대적으로 크면 목적이 되는 요인의 효과가 있다고 할 수 있음
                * (=)F = MSA / MSE가 커진다
        * 대응이 있는 일원배치 분산분석
            *  목적요인이 하나이고, 동일 개체를 각 조건(요인) 아래에서 측정하는 데이터에 실시하는 분산분석
            * 개체 차이가 큰 경우에는 보다 높은 정밀도를 기대할 수 있음
            * 대응이 없는 일원배치 분산분석과 거의 똑같으나 군내변동에 개체 간 변동을 제거해야함
                * 개체 간의 변동
                    * 개체 차이에서 생기는 변동
                    * 자유도 : 개체의 종류 - 1
                * 제거된 군내 변동
                    * 제거된 군내 변동 : 군내변동 - 개체 간 변동
                    * 자유도 : (데이터 수 - 집단수) - (개체의 종류 - 1)
                    * MSA = 제거된 군내 변동 / 자유도
        * 이원배치 분산분석
            * 목적이 되는 요인이 둘인 경우의 분산분석
            * 각 요인의 주효과 외에도 교호작용을 검정 할 수 있음
                * 주효과
                    * 각 요인이 발휘하는 효과
                    * 이원배치 이상에서 사용하는 용어
                * 교호작용
                    * 한쪽 요인이 취하는 수준에 따라 한쪽 요인이 받는 요인의 조합 효과
                    * 상승효과와 상쇄효과가 있음
                * 교호작용을 검정하기 위해서는 각 수준의 조합내에서 실험의 반복이 필요
            * 구체적으로..
                * SST
                    * 총변동
                * SSTR
                    * 주효과와 교호작용을 합친 요인효과에 의한 변동
                    * 자유도 : 요인 A의 종류 * 요인 B의 종류 - 1
                    * SSTR = SSA + SSB + SSAB
                * SSA
                    * 요인 A의 주효과에 의한 변동
                    * 자유도 : 요인 A의 종류 - 1
                    * MSA : SSA / 자유도
                * SSB
                    * 요인 B의 주효과에 의한 변동
                    * 자유도 : 요인 B의 종류 - 1
                    * MSB : SSB / 자유도
                * SSAB
                    * 교호작용에 의한 변동
                    * 자유도 : 요인효과에 의한 자유도에서 요인 A, B의 주효과 자유도를 뺌
                    * SSAB = (각 조합의 반복 수가 같은경우 = 균형)SSTR - SSA - SSB 또는 공식
                    * MSAB = SSAB / 자유도
                * SSE
                    * 오차효과에 의한 변동
                    * 자유도 : 데이터의 수 - (요인 A의 종류 * 요인 B의 종류)
                    * MSE : SSE / 자유도

            * 가설검정
                * 요인 A, B의 주효과, 그리고 교호작용의 세 효과에 대해 검정
                * **어느 쪽도 효과 없음이 귀무가설**
* 여러 집단의 등분산 검정
    * 바트레트 검정
        * 분산분석도 등분산을 전제로 하고 있으므로, 먼저 검정해 두는 것이 바람직하다.
        * 가설
            * 각 집단의 모분산에는 차이가 없다(등분산)
            * 각 집단의 모분산에는 1쌍 이상으로 차이가 있다(이분산)
        * 검정통계량
            * 카이제곱 분포를 따르는 전체 집단의 분산의 치우친 정도
        * 가설의 판정
            * p-value와 유의수준 비교
            * 검정통계량과 임계값(한계값) 비교
* 다중성
    * 분산분산의 결점
        * 어느 집단 간에 차이가 있는지를 특정 할 수 없음
    * 다중비교
        * 의미 있는 차이가 있는 쌍을 찾기 위해 두 집단의 평균 차이 검정을 각 집단에서 반복하는 것
        * 다중비교를 진행해도 되나, 같은 데이터를 가지고 검정을 반복해서는 안됨(-> 다중성)
    * 다중성
        * 같은 데이터 세트에 대해 여러 번 검정을 반복(= 다중비교)하면 제1종 과오를 범할 확률이 높아진다는 것
            * 즉, 큰 유의수준으로 검정을 하게 된다는 것
        * H0 : μ1 = μ2 = ... = μn 을 기각할 확률이 커진다는 의미
* 다중비교법(multiple comparison test)
    * 같은 데이터에 대해 검정을 반복하고 싶은 경우에 이용
    * 검정을 반복해도 각 검정에 대한 검정통계량이 기각역에 쉽게 들어가지 않도록 보정한 방법들
        * 종류
            * 유의수준 보정형
                * 반복하는 횟수에 따라 유의수준을 작게 함으로써 기각격이 넓어지지 않게 함
                * 본페로니(Bonferroni) 법
                    * 미리 반복 횟수로 나눈 유의수준으로 검정하는 방법
                    * 반복 횟수가 5를 초과하면 너무 보수적이 되는 결점도 있음
            * 검정통계량 보정형
                * 집단 수에 따라 검정통계량을 작게 해서 기각역에 들어가기 어렵게 만듬
                * 셰페(Scheffe) 법
                    * 여러 집단을 정리해서 두 집단으로 나누고, 이들을 비교함
                        * 대비
                            * 대비계수를 정해 집단을 나누고 이들을 비교하는 것
                        * 원래는 무수히 많은 조합을 대상으로 할 수 있음
                    * 검정통계량은 F분포를 따름
                        * 검정통계량은 집단 수에 반비례함
            * 분포 보정형
                * 반복하는 횟수가 늘어도 (전체 검정에 대한)유의수준이 커지지 않는(즉, 전체 집단 간의 차이가 없다는 귀무가설을 기각할 확률이 커지지 않는) 독자적인 분포로부터 임계값을 읽어 판정함
                * 튜키(Tukey) 법
                    * 가장 일반적인 다중비교법
                    * 각 집단 들의 표본 크기가 같아야 함(균형)
                    * MSE를 사용한 t값을 스튜던트화된 범위의 분포에서 도출한 q 값을 임계값으로 검정함
                        * 스튜던트화된 범위의 분포(스튜던트화 범위 분포)
                            * 가장 큰 평균의 집단과 가장 작은 평균의 집단을 통해 도출된 통계량의 분포
                        * q 값
                            * 스튜던트화된 범위의 분포에서 유의수준에 대응되는 값
                            * q분포표에서 읽어옴
                * 튜키·그레이머(Tukey Kramer) 법
                    * 튜키법을 불균형한 경우에도 사용할 수 있도록 개선한 방법
                    * t 값을 계산할 때 양 집단의 표본크기를 고려해줌
                    * 임계값은 q분포표에서 읽은 값을 sqrt(2)로 나눈 값
                * 던넷법(Dunnett)
                    * 대조군과 처리군의 비교만 함
                        * 대조군과 유의차가 있는지 없는지만 알고 싶은 경우에 사용
                    * 검정통계량은 튜키·크레이머법과 완전히 같음
                    * 집단 간에 발생하는 상관계수 분을 나누고 뺌으로써 다중성이 보정됨
                    * 임계값은 던넷법 전용표에서 읽어옴
                        * 양측검정, 편측검정의 차이 뿐만 아니라 상관계수를 고려해서 읽음
* caution
    * 대조군의 설정
        * 처리를 하지 않은 실험군
        * 대조실험의 기본적인 요건
        * 요인의 유효성을 추량하기 위해 대조건 설정 필요
            * ex> 비료 없음
    * 실험의 반복 필요
        * 분산분석은 데이터가 분산되어 있지 않으면 분석을 할 수 없음
        * 각 요인별로 여러 번, 독립 된 실험을 반복할 필요가 있음
    * 제곱합의 유형
        * (이원배치 분산분석과 같은경우)각 수준의 조합의 크기가 같지 않은 경우를 불균형이라고 함
        * 불균형의 경우 분산분석이 원래 전제하고 있는 각 요인은 직교해 있다(무상관이다)라는 조건이 깨져버리는 경우가 많음
        * 즉, 계산하는 순서에 따라 값이 달라짐
            * SSTR != SSA + SSB + SSAB
        * 계산하는 순번이 영향을 미치지 않도록 상관의 분량을 조정하는 방법의 종류를 제곱합 타입(I~IV)이라고 함